<!doctype html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>求职</title>
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/css/edua-icons.css">
    <link rel="stylesheet" type="text/css" href="/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/css/owl.carousel.css">
    <link rel="stylesheet" type="text/css" href="/css/owl.transitions.css">
    <link rel="stylesheet" type="text/css" href="/css/cubeportfolio.min.css">
    <link rel="stylesheet" type="text/css" href="/css/settings.css">
    <link rel="stylesheet" type="text/css" href="/css/bootsnav.css">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/loader.css">

    <link href="https://cdn.bootcss.com/toastr.js/latest/css/toastr.css" rel="stylesheet">
    <link rel="icon" href="/images/favicon.png">
    <link rel="stylesheet" type="text/css" href="/css/condition/style.css">
    <style>
        .emp-item{
            margin-top:30px;
            margin-left:100px;
            width: 80%;
            padding-bottom:30px;
            border: rgba(189, 189, 193, 0.63) 1px;
            border-style:none none solid none;
        }
        .emp-item img:hover{
            transform:scale(1.1);
        }
        .emp-item img{
            transition:all .5s ease-in-out;
        }
        .emp-item .avatar{
            overflow:hidden;
        }
        .up{
            font-size:1.2em;
            padding-top:10px;
            font-weight:lighter;
        }
        i.icon{
            margin-left:10px;
        }
        .cont{
            padding-top:10px;
            border:1px solid #d8d5d5b5;
            border-style: none solid none none;
        }
        .cont>a{
            font-size:1.7em;
            font-weight:bold;
        }
        .com{
            margin-top:20px;
        }
        .com a{
            font-size:1.3em;
        }
        .emp-item:nth-last-child(1){
            border-style:none none none none;
        }
        .total-page{
            font-size: .8em;
        }
        .total-page::before{
            content: '共 ';
        }
        .total-page::after{
            content: ' 页';
        }
        .page-off{
            margin-left: 30px;
        }
        .page-item{
            padding: 2px 5px;
            margin:10px;
            transition: all .2s;
            cursor: pointer;
            color:black;
        }
        .page-item:hover{
            color: #1ec9ff;
        }
        .page-ellipsis::after{
            content: '...';
        }
        .this-page{
            margin:10px;
            color: #c2ebf0;
            padding: 2px 5px;
            background: #51514f;
        }
        .paging-box{
            font-size: 1.5em;
            margin: 80px 30px;
        }
    </style>
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
<a href="#" class="scrollToTop"><i class="fa fa-angle-up"></i></a>
<!--Loader-->
<div class="loader">
    <div class="bouncybox">
        <div class="bouncy"></div>
    </div>
</div>



<script type="text/javascript" src="/js/header.js"></script>

<!--Search-->
<div id="search">
    <button type="button" class="close">×</button>
    <form>
        <input type="search" value="" placeholder="Search here...."  required/>
        <button type="submit" class="btn btn_common blue">Search</button>
    </form>
</div>



<!--Page Header-->
<section class="page_header padding-top">
    <div class="container">
        <div class="row">
            <div class="col-md-12 page-content">
                <h1>求职检索</h1>
                <p>搜索你最需要的课程</p>
                <div class="page_nav">
                    <span>你的位置:</span> <a href="/index">首页</a> <span><i class="fa fa-angle-double-right"></i>求职检索</span>
                </div>
            </div>
        </div>
    </div>
</section>
<!--Page Header-->

<section class="col-md-8">
    <div class="container">
        <div class="row">
            <div class="col-md-12  page-content">
                <ul class="select">
                    <li class="select-list">
                        <dl id="select1">
                            <dt>排序：</dt>
                            <dd class="select-all selected"><a href="javascript:;">默认排序</a></dd>
                            <dd><a data-key="salary" href="javascript:;">最高工资</a></dd>
                            <dd><a data-key="new" href="javascript:;">最新发布</a></dd>
                        </dl>
                        <dl id="select2">
                            <dt>就职地点：</dt>
                            <dd class="select-all selected"><a href="javascript:;">全国</a></dd>
                            <dd><a data-key="北京" href="javascript:;">北京</a></dd>
                            <dd><a data-key="上海" href="javascript:;">上海</a></dd>
                            <dd><a data-key="广州" href="javascript:;">广州</a></dd>
                            <dd><a data-key="深圳" href="javascript:;">深圳</a></dd>
                            <dd><a data-key="杭州" href="javascript:;">杭州</a></dd>
                            <dd><a data-key="南京" href="javascript:;">南京</a></dd>
                            <dd><a data-key="成都" href="javascript:;">成都</a></dd>
                            <dd><a data-key="厦门" href="javascript:;">厦门</a></dd>
                            <dd><a data-key="武汉" href="javascript:;">武汉</a></dd>
                            <dd><a data-key="西安" href="javascript:;">西安</a></dd>
                            <dd><a data-key="长沙" href="javascript:;">长沙</a></dd>
                            <dd><a data-key="哈尔滨" href="javascript:;">哈尔滨</a></dd>
                            <dd><a data-key="合肥" href="javascript:;">合肥</a></dd>
                            <dd><a data-key="其他" href="javascript:;">其他</a></dd>
                        </dl>
                        <dl id="select3">
                            <dt>职业分类：</dt>
                            <dd class="select-all selected"><a href="javascript:;">全部</a></dd>
                        </dl>
                        <dl>
                            <dt>关键字：</dt>
                            <dd><input type="text" id="keyword"> <span class="btn btn-default search-keyword">搜索</span></dd>
                        </dl>
                    </li>
                </ul>
            </div>
        </div>
    </div>

</section>


<!-- Courses -->
<section id="course_all" class="padding-bottom">
    <div class="container">

    </div>
</section>
<!-- Courses ends -->

<section>
    <div class="paging-box">
        <span class="total-page">20</span>
    </div>
</section>
<script type="text/javascript" src="/js/footer.js"></script>

<script src="/js/jquery-2.2.3.js"></script>
<script src="https://cdn.bootcss.com/toastr.js/latest/js/toastr.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/bootsnav.js"></script>
<script src="/js/jquery.appear.js"></script>
<script src="/js/jquery-countTo.js"></script>
<script src="/js/jquery.parallax-1.1.3.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/jquery.cubeportfolio.min.js"></script>
<script src="/js/jquery.themepunch.tools.min.js"></script>
<script src="/js/jquery.themepunch.revolution.min.js"></script>
<script src="/js/revolution.extension.layeranimation.min.js"></script>
<script src="/js/revolution.extension.navigation.min.js"></script>
<script src="/js/revolution.extension.parallax.min.js"></script>
<script src="/js/revolution.extension.slideanims.min.js"></script>
<script src="/js/revolution.extension.video.min.js"></script>
<script src="/js/wow.min.js"></script>
<script src="/js/functions.js"></script>

<script type="text/javascript" src="/js/condition/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="/js/condition/script.js"></script>

<script>
    var $div = $('#course_all').find('div.container');
    var courseFilter = {page:1};//点击上方的筛选框需要改变本变量
    //data是list
    //companyId,companyName,title,id,salary,location
    function showResult(data) {
        $div.empty();
        for(let i = 0; i < data.length; i++){
            let tstr = '';
            if(data[i].isPractice)
                tstr = '<span class="label label-primary right" style="font-size:1.3em">实习</span> ';
            let $$div = $('<div class="emp-item col-md-10">' +
                '<div class="avatar col-md-2"><a href="/working/'+data[i].companyId
                +'/job/'+data[i].id+'/" target="_blank">' +
                '<img src="/get/company/logo/'+data[i].companyId+'" height="80">' +
                '</a></div>' +
                '<div class="cont col-md-5">' +
                '<a href="/working/'+data[i].companyId+'/job/'+data[i].id+'/" target="_blank">'+data[i].title+'</a>' +
                tstr +
                '<div class="com"><a href="/working/'+data[i].companyId+'/job/'+data[i].id+
                '/" target="_blank">'+data[i].companyName+'</a></div>' +
                '</div>' +
                '<div class="info col-md-5">' +
                '<div class="up"><span><i class="icon icon-location"></i>'+data[i].location+'</span>' +
                '<span><i class="icon icon-moneybag"></i>'+data[i].salary+'</span></div>' +
                '</div>');
            $div.append($$div);
        }
    }
    function changePageBox(curPage) {
        if(curPage === undefined)
            curPage = 1;
        else curPage = parseInt(curPage);
        $('.total-page').each(function () {
            let tot = $(this).html();
            $(this).siblings().remove();
            let $span = $('<span class="page-off"></span>');
            $span.append('<input type="hidden" class="cur-page" value="'+curPage+'">');
            if(tot>10){//要根据当前页来划分
                for(let i = 1; i <= 6; i++){
                    if(i===curPage)
                        $span.append('<span class="this-page">'+i+'</span>');
                    else
                        $span.append('<span class="page-item">'+i+'</span>');
                }
                if(curPage<=8){
                    for(let i = 7; i <= 9; i++){
                        if(i===curPage)
                            $span.append('<span class="this-page">'+i+'</span>');
                        else
                            $span.append('<span class="page-item">'+i+'</span>');
                    }
                    $span.append('<span class="page-ellipsis"></span>');
                    $span.append('<span class="page-item">'+tot+'</span>');
                }else if(curPage<=tot-1){
                    $span.append('<span class="page-ellipsis"></span>');
                    $span.append('<span class="page-item">'+(curPage-1)+'</span>');
                    $span.append('<span class="this-page">'+(curPage)+'</span>');
                    $span.append('<span class="page-item">'+(curPage+1)+'</span>');
                    if(curPage+1<tot-1)
                        $span.append('<span class="page-ellipsis"></span>');
                    if(curPage+1<tot)
                        $span.append('<span class="page-item">'+tot+'</span>');
                }else{
                    $span.append('<span class="page-item">'+7+'</span>');
                    $span.append('<span class="page-item">'+8+'</span>');
                    $span.append('<span class="page-ellipsis"></span>');
                    $span.append('<span class="page-item">'+(tot-1)+'</span>');
                    $span.append('<span class="this-page">'+tot+'</span>');
                }
            }else{
                for(let i = 1; i <= tot; i++){
                    if(i===curPage)
                        $span.append('<span class="this-page">'+i+'</span>');
                    else
                        $span.append('<span class="page-item">'+i+'</span>');
                }
            }
            $span.find('.page-item').on('click',function () {
                let targetPage = parseInt($(this).html());
                courseFilter.page = targetPage;//其余参数不变
                $('body,html').animate({scrollTop:300},500);
                getCourseByFilter(courseFilter);
            });//完成初始化，点击就ajax获取
            $(this).after($span);//添加节点
        });
    }
    //opt.page:页码
    //opt.order:排序方式
    //opt.field:领域
    //opt.location:地点
    //opt.keyword:关键字
    //opt.professionId:职业id
    function getCourseByFilter(opt) {
        console.log("筛选器：");
        console.log(opt);
        $.get('/get/working',opt,function (data) {
            data = JSON.parse(data);
            if(data.errorCode==='00'){
                let pager = data.returnObject;
                //需要针对pager返回的总页码来分页
                //返回总条数
                let totalPage = Math.ceil(pager.pages);//一页20条
                $('.total-page').html(totalPage);
                showResult(pager.records);
            }else{
                toastr.warning('未知错误');
            }
            changePageBox(opt.page);
        }).error(function () {
            toastr.warning('未知错误');
        });
    }
    $('.search-keyword').on('click',function (object) {
        courseFilter.keyword = $('#keyword').val();
        getCourseByFilter(courseFilter);
    });
</script>

<script type="text/javascript">
    $(document).ready(function(){
        $.get("/getVocationType",function (data) {
            data = JSON.parse(data);
            if(data.errorCode=='00'){
                lst = data.returnObject;
                let $s3 = $('#select3');
                lst.forEach(function (val,idx) {
                    $s3.append('<dd><a data-key="'+val.professionId+'" href="javascript:;">'+val.profession+'</a></dd>');
                });
                $("#select3 dd").click(function () {
                    $(this).addClass("selected").siblings().removeClass("selected");
                    if ($(this).hasClass("select-all")) {
                        courseFilter.professionId = null;//默认为空
                    } else {
                        courseFilter.professionId = $(this).find('a').attr('data-key');
                    }
                    getCourseByFilter(courseFilter);
                });
            }
        });
        $("#select1 dd").click(function () {
            $(this).addClass("selected").siblings().removeClass("selected");
            if ($(this).hasClass("select-all")) {
                courseFilter.order = null;//默认为空
            } else {
                courseFilter.order = $(this).find('a').attr('data-key');
            }
            getCourseByFilter(courseFilter);
        });
        $("#select2 dd").click(function () {
            $(this).addClass("selected").siblings().removeClass("selected");
            if ($(this).hasClass("select-all")) {
                courseFilter.location = null;//默认为空
            } else {
                courseFilter.location = $(this).find('a').attr('data-key');
            }
            getCourseByFilter(courseFilter);
        });

        getCourseByFilter(courseFilter);

    });</script>

</body>
</html>
